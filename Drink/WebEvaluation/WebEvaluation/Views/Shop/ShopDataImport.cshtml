@{
    ViewBag.IMG = "../../Content/images/shop.png";
    ViewBag.color = "#7f00ba";
    ViewBag.Title = "店舗インポート";
}
<body>
    <div class="jumbotron">
        <div class="row" style="margin-top: 30px;">
            <div class="col-lg-12 text-right">
                <a id="csv_btn" href="#">CSVダウンロード</a>
                &nbsp;<img src="/Content/images/ic-teleline.png"> &nbsp;
                <a href="../../Shop/MasterManager?isPostBack=1">店舗一覧</a>
                &nbsp;<img src="/Content/images/ic-teleline.png"> &nbsp;
                <a href="/Help/店舗インポート操作マニュアル.docx">操作マニュアル</a>
            </div>
        </div>
        <div class="row">
            @using (Html.BeginForm("ShopDataImport", "Shop", FormMethod.Post, new { @class = "form-horizontal", enctype = "multipart/form-data", @onsubmit = "return checkForm()" }))
            {
                <div class="party-import-box">
                    <fieldset>
                        <div class="form-group" style="margin-top:20px;">
                            <label class="col-lg-3 control-label">ファイル名</label>
                            <div class="col-lg-7">
                                <div class="input-group shop">
                                    <input type="text" class="form-control" id="shopDataFileLabel" style="" onfocus=this.blur() />
                                    <input type="file" name="datafile" id="shopDataFile" title="店舗インポート" style="width: 37px;height: 32px;margin: 0;padding: 0;opacity: 0;top: 0;left: 390px;position: absolute;cursor: pointer;z-index:10000000;" />

                                    <span id="btn_shopImport" class="input-group-addon input-sm">
                                        <i class="glyphicon glyphicon-file" style="cursor: pointer;"></i>
                                    </span>
                                </div>
                            </div>
                        </div>
                    </fieldset>
                </div>

                <div class="form-group" style="width:100%; text-align:center;">
                    <button type="submit" id="sub_shopImport" class="btn btn-success ">実行</button>
                </div>
            }
        </div>
    </div>
</body>
<script type="text/javascript">

    function checkForm() {

        if ($("#shopDataFile").val() == "") {
            SMAT.Service.toastr("CSVファイルを選択してください！", "error");
            return false;
        }
        else {
            var fileName = $("#shopDataFile").val().split(".");
            if (fileName[fileName.length - 1].toLocaleUpperCase() != "CSV"){
                SMAT.Service.toastr("CSVファイルを選択してください！", "error");
                return false;
            }

        }
        $('<div id="toast-container" class="toast-top-center" aria-live="polite" role="alert"><div class="toast toast-info" style="opacity: 1;"><button class="toast-close-button" role="button"></button><div class="toast-message">処理中。。。しばらくお待ち下さい。</div></div></div>').appendTo($('body'));
        return true;
    }

    $("#csv_btn").bind('click', function (e) {

        SMAT.Service.getServerFile({
            url: "@Url.Action("detailCsv", "Shop")",
            params: {}
        });
    });

    $("#btn_shopImport").bind("click", function (e) {
        $("#shopDataFile").click();
    });

    $("#shopDataFile").bind("change", function (e) {
        var fileName = $(this).val().split("\\");
        $("#shopDataFileLabel").val(fileName[fileName.length - 1]);
        $("#sub_shopImport").show();
    });
</script>