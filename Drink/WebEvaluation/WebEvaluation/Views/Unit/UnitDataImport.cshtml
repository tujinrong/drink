
@*@{
    ViewBag.Title = "組織インポート";
    ViewBag.color = "#7f00ba";
    ViewBag.IMG = "../../Content/images/shop.png";
}

<div class="jumbotron">
    <div class="row" style="margin-top: 30px;">
        <div class="col-lg-12 text-right"><a id="csv_btn" href="#">CSVダウンロード</a> &nbsp;<img src="/Content/images/ic-teleline.png"> &nbsp;<a href="../../Unit/Index">組織管理</a></div>
    </div>
    <div class="row">
        @using (Html.BeginForm("UnitDataImport", "Unit", FormMethod.Post, new { @class = "form-horizontal", enctype = "multipart/form-data", @onsubmit = "return checkForm()" }))
        {
            <div class="party-import-box">
                <fieldset>
                    <div class="form-group" style="margin-top:20px;">
                        <label class="col-lg-3 control-label">ファイル名</label>
                        <div class="col-lg-7">
                            <div class="input-group unit">
                                <input type="text" class="form-control" id="unitDataFileLabel" style="" onfocus=this.blur() />
                                <span id="btn_unitImport" class="input-group-addon input-sm">
                                    <i class="glyphicon glyphicon-file" style="cursor: pointer;"></i>
                                </span>
                            </div>
                            <input type="file" name="datafile" id="unitDataFile" title="組織インポート" style="visibility:hidden" />
                        </div>
                    </div>
                </fieldset>
            </div>
            <div class="form-group" style="width:100%; text-align:center;">
                <button type="submit" id="sub_unitImport" class="btn btn-success ">実行</button>
            </div>
        }
    </div>
</div>

<script type="text/javascript">

    function checkForm() {

        if ($("#unitDataFile").val() == "") {
            SMAT.Service.toastr("CSVファイルを選択してください！", "error");
            return false;
        }
        else {
            var fileName = $("#unitDataFile").val().split(".");
            if (fileName[fileName.length - 1].toLocaleUpperCase() != "CSV"){
                SMAT.Service.toastr("CSVファイルを選択してください！", "error");
                return false;
            }
        }
        return true;
    }

    $("#csv_btn").bind('click', function (e) {
        SMAT.Service.getServerFile({
            url: "@Url.Action("detailCsv", "Unit")",
            params: {}
        });
    });

    $("#btn_unitImport").bind("click", function (e) {
        $("#unitDataFile").click();
    });

    $("#unitDataFile").bind("change", function (e) {
        var fileName = $(this).val().split("\\");
        $("#unitDataFileLabel").val(fileName[fileName.length - 1]);
        $("#sub_unitImport").show();
    });
</script>*@