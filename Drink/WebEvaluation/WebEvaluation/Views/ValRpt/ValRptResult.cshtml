@model IEnumerable<WebEvaluation.ViewModels.ValRptResultViewModel>
@using PagedList.Mvc;
@{
    ViewBag.IMG = "../../Content/icon/m07.png";
    ViewBag.Title = "テレフォンレポート総合評価検索結果";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<body>
    <div class="jumbotron">
        <!--アンケート評価結果＆BUTTON------------------------------------------->
        <form class="form-horizontal">
            <div class="form-group">
                <div class="col-lg-12 control-label">
                    @Html.OpenWindow("プレビュー", "/ValRptResultPreview", "1440", "800", new { Time = ViewBag.Time, Year = ViewBag.Year, Season = ViewBag.Season, Months = ViewBag.Months, DateFrom = ViewBag.DateFrom, DateTo = ViewBag.DateTo,Range = ViewBag.Range, divisionCD = ViewBag.divisionCD,ShopCD = ViewBag.ShopCD, Host = ViewBag.Host, Sort = ViewBag.Sort, Show = ViewBag.Show }, new { @class = "btn btn-info btn-sm" })
                    @Html.ButtonAction(true, "CSV出力", "/ResultCsv", new { Time = ViewBag.Time, Year = ViewBag.Year, Season = ViewBag.Season, Months = ViewBag.Months, DateFrom = ViewBag.DateFrom, DateTo = ViewBag.DateTo, Range = ViewBag.Range, divisionCD = ViewBag.divisionCD, ShopCD = ViewBag.ShopCD, Host = ViewBag.Host, Sort = ViewBag.Sort, Show = ViewBag.Show }, new { @class = "btn btn-success btn-sm" })
                    @Html.ButtonAction(false, "再検索", "ValRptSearch", new { Time = ViewBag.Time, Year = ViewBag.Year, Season = ViewBag.Season, Months = ViewBag.Months, DateFrom = ViewBag.DateFrom, DateTo = ViewBag.DateTo, Range = ViewBag.Range, divisionCD = ViewBag.divisionCD, ShopCD = ViewBag.ShopCD, Host = ViewBag.Host, Sort = ViewBag.Sort, Show = ViewBag.Show }, new { @class = "btn btn-primary btn-sm" })
                </div>
            </div>
        </form>
        <h3 class="panel-title" style="margin-top: 20px; margin-bottom:20px;"><font color="#4d4d4d"><strong>ナショナル平均:</strong>&nbsp;@ViewBag.countryAvg</font></h3>
        <!--アンケート評価結果-->
        <table class="table table-condensed table-bordered table-hover text-center" border="1">
            <thead>
                <tr style="background-color:#e9e9e9">
                    <th class="text-center">№</th>
                    <th class="text-center">事業部</th>
                    <th class="text-center">グループ</th>
                    <th class="text-center">店舗名</th>
                    <th class="text-center">SS</th>
                    <th class="text-center">S</th>
                    <th class="text-center">A</th>
                    <th class="text-center">B</th>
                    <th class="text-center">C</th>
                    <th class="text-center">D</th>
                    <th class="text-center">E</th>
                    <th class="text-center">F</th>
                    <th class="text-center">評価件数</th>
                    <th class="text-center">総点数</th>

                    @{
                        List<string> show = ViewBag.Show;    
                    }
                    @if (null != show && show.Contains("eva"))
                    { 
                        <th class="text-center">平均点</th>
                    }
                    @if (null != show && show.Contains("group"))
                    {
                        <th class="text-center">グループ平均</th>
                    }
                    @if (null != show && show.Contains("div"))
                    {
                        <th class="text-center">事業部平均</th>
                    }
                </tr>
            </thead>
            @{var no = 0;}
            @foreach (var item in Model)
            {
                <tr style="background-color:white">
                    <td class="text-right">@(++no)</td>
                    <td class="text-left">@Html.DisplayFor(modelItem => item.DivName)</td>
                    <td class="text-left">@Html.DisplayFor(modelItem => item.GroupName)</td>
                    <td class="text-left">@Html.DisplayFor(modelItem => item.ShopCD)</td>
                    <td class="text-right">@Html.DisplayFor(modelItem => item.EvaSS)</td>
                    <td class="text-right">@Html.DisplayFor(modelItem => item.EvaS)</td>
                    <td class="text-right">@Html.DisplayFor(modelItem => item.EvaA)</td>
                    <td class="text-right">@Html.DisplayFor(modelItem => item.EvaB)</td>
                    <td class="text-right">@Html.DisplayFor(modelItem => item.EvaC)</td>
                    <td class="text-right">@Html.DisplayFor(modelItem => item.EvaD)</td>
                    <td class="text-right">@Html.DisplayFor(modelItem => item.EvaE)</td>
                    <td class="text-right">@Html.DisplayFor(modelItem => item.EvaF)</td>
                    <td class="text-right">@Html.DisplayFor(modelItem => item.CountAll)</td>
                    <td class="text-right">@Html.DisplayFor(modelItem => item.SumAll)</td>

                    @if (null != show && show.Contains("eva"))
                    {
                        <td class="text-right">@Html.DisplayFor(modelItem => item.Avg)</td>
                    }
                    @if (null != show && show.Contains("group"))
                    {
                        <td class="text-right">@Html.DisplayFor(modelItem => item.AvgGroup)</td>
                    }
                    @if (null != show && show.Contains("div"))
                    {
                        <td class="text-right">@Html.DisplayFor(modelItem => item.AvgDiv)</td>
                    }
                </tr>
            }
        </table>
    </div>
</body>
